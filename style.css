/* ===================== 디자인 리팩터링 (세련/일관/접근성) ===================== */
/* 1. 컬러·스타일 토큰 */
:root {
  --c-bg-page: #f4f6fb;
  --c-bg-panel: #ffffff;
  --c-bg-panel-alt: #f9fbff;
  --c-border: #d9dfec;
  --c-border-strong: #b9c4db;
  --c-primary: #3553ff;
  --c-primary-accent: #1b95e6;
  --c-primary-soft: #e2e9ff;
  --c-danger: #ff4b55;
  --c-danger-bg: #fff4f4;
  --c-success: #21a365;
  --c-success-bg: #e9fff4;
  --c-text: #2a2f3a;
  --c-text-soft: #5b657a;
  --c-focus: #ffbf2f;
  --c-highlight: #ffe1d9;
  --radius-xs: 4px;
  --radius-s: 6px;
  --radius-m: 12px;
  --radius-l: 22px;
  --shadow-s: 0 1px 3px rgba(0,0,0,.08), 0 0 0 1px rgba(0,0,0,.03);
  --shadow-m: 0 4px 16px -2px rgba(0,40,120,.15), 0 2px 6px rgba(0,0,0,.06);
  --shadow-focus: 0 0 0 3px var(--c-primary-soft);
  --gradient-btn: linear-gradient(90deg,var(--c-primary) 70%,var(--c-primary-accent) 100%);
  --transition: .18s cubic-bezier(.4,.14,.3,1);
  --font-stack: "Segoe UI","Apple SD Gothic Neo","Malgun Gothic",system-ui,sans-serif;
  --font-ui: "Pretendard Variable", -apple-system, BlinkMacSystemFont,
             "Segoe UI", "Roboto", "Noto Sans KR",
             "Apple SD Gothic Neo", "Malgun Gothic", system-ui, sans-serif;
  --font-mono: "JetBrains Mono", "Cascadia Code", "D2Coding",
               "Consolas", "Menlo", ui-monospace, monospace;
  --font-size-base: 15px;
  --line-ui: 1.6;

  /* 0) 스크롤바 토큰 추가 */
  --sb-size: 12px;
  --sb-radius: 8px;
  --sb-track: #eaf0fa;
  --sb-thumb: #c3cfe4;
  --sb-thumb-hover: #aebad1;
}
.theme-dark {
  --c-bg-page: #151922;
  --c-bg-panel: #1f2530;
  --c-bg-panel-alt: #272f3c;
  --c-border: #384253;
  --c-border-strong: #4b576b;
  --c-primary: #5a7dff;
  --c-primary-accent: #37b2ff;
  --c-primary-soft: #233555;
  --c-text: #e7edf6;
  --c-text-soft: #a4b1c6;
  --c-danger-bg: #3a2224;
  --c-success-bg: #1e3a2c;
  --c-highlight: #553a32;
  --shadow-s: 0 1px 3px rgba(0,0,0,.6);
  --shadow-m: 0 6px 24px -4px rgba(0,0,0,.55), 0 2px 8px rgba(0,0,0,.5);
  --sb-track: #1e2531;
  --sb-thumb: #45536a;
  --sb-thumb-hover: #556680;
  background: var(--c-bg-page);
  color: var(--c-text);
}

/* 모바일 브라우저 자동 확대 방지 */
html { -webkit-text-size-adjust: 100%; text-size-adjust: 100%; }

@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: .001ms !important;
    animation-iteration-count: 1 !important;
    transition: none !important;
    scroll-behavior: auto !important;
  }
}

/* 2. 다크 테마 (선택) */
/* .theme-dark { ... }  부분은 위에서 --c-* 변수를 통해 설정됨 */

/* 3. 페이지 기본 */
body {
  background: var(--c-bg-page);
  font-family: var(--font-stack);
  margin: 0;
  color: var(--c-text);
  -webkit-font-smoothing: antialiased;
}

.container {
  max-width: 900px;
  margin: 52px auto;
  background: var(--c-bg-panel);
  border-radius: var(--radius-l);
  box-shadow: var(--shadow-m);
  padding: 40px 38px 36px;
  border: 1px solid var(--c-border);
  position: relative;
  transition: box-shadow var(--transition), background var(--transition), border-color var(--transition);
}

.container:hover {
  box-shadow: 0 8px 34px -8px rgba(40,70,170,.22), 0 4px 14px rgba(0,0,0,.08);
}

h2 {
  margin: 0 0 30px;
  font-size: 1.5rem;
  font-weight: 700;
  letter-spacing: -0.5px;
  color: var(--c-primary);
}

h2, h3, h4 {
  font-family: var(--font-ui);
  font-weight: 600;
  letter-spacing: -0.3px;
}

/* 4. CodeMirror */
.CodeMirror {
  border: 1.5px solid var(--c-border-strong);
  background: var(--c-bg-panel-alt);
  border-radius: var(--radius-m);
  font-size: 1.04rem;
  line-height: 1.7;
  min-height: 240px;
  transition: border-color var(--transition), background var(--transition);
  font-family: var(--font-mono);
  font-size: clamp(13px, 0.95vw, 15px);
  line-height: 1.65;
  font-weight: 450;
  letter-spacing: 0;
}

.CodeMirror-focused {
  border-color: var(--c-primary);
  background: #f5f8ff;
  box-shadow: var(--shadow-focus);
}

/* === Dark Theme Readability Upgrade ======================================= */
.theme-dark .CodeMirror {
  background: #1f2530;
  color: #e6edf5;
  border-color: #425069;
}
.theme-dark .CodeMirror-lines {
  padding: 8px 0 12px;
}
.theme-dark .CodeMirror pre {
  font-variant-ligatures: none;
}
.theme-dark .CodeMirror-gutters {
  background: #1b2029;
  border-right: 1px solid #3a4556;
  color: #7f8ba1;
}
.theme-dark .CodeMirror-linenumber {
  color: #65738a;
}
.theme-dark .CodeMirror-cursor {
  border-left: 2px solid #ffc347;
}
.theme-dark .CodeMirror-selected {
  background: rgba(80,130,255,.28) !important;
}
.theme-dark .CodeMirror-focused .CodeMirror-selected {
  background: rgba(90,150,255,.36) !important;
}
.theme-dark .CodeMirror ::selection {
  background: rgba(90,150,255,.36);
}
.theme-dark .CodeMirror-line::selection,
.theme-dark .CodeMirror-line > span::selection,
.theme-dark .CodeMirror-line > span > span::selection {
  background: rgba(90,150,255,.36);
}

/* Token-ish generic (since markdown mode is light) */
.theme-dark .cm-header        { color:#89b4ff; }
.theme-dark .cm-strong        { color:#ffc86b; }
.theme-dark .cm-em            { color:#ffae9b; }
.theme-dark .cm-link          { color:#6dcfff; text-decoration:underline; }
.theme-dark .cm-string        { color:#9be480; }
.theme-dark .cm-quote         { color:#7bc2ff; opacity:.95; }
.theme-dark .cm-comment       { color:#6d7e92; font-style:italic; }
.theme-dark .cm-url           { color:#54c1ff; }
.theme-dark .cm-number        { color:#ffc76d; }
.theme-dark .cm-keyword       { color:#caa6ff; }
.theme-dark .cm-hr            { color:#6d7e92; }

/* Scrollbar */
.theme-dark .CodeMirror-scrollbar-filler,
.theme-dark .CodeMirror-gutter-filler { background:#1f2530; }
.theme-dark .CodeMirror ::-webkit-scrollbar {
  width:10px;
}
.theme-dark .CodeMirror ::-webkit-scrollbar-thumb {
  background:#394557;
  border-radius:6px;
}
.theme-dark .CodeMirror ::-webkit-scrollbar-thumb:hover {
  background:#46546a;
}

/* Error highlight contrast */
.theme-dark .error-highlight {
  background:#52312a !important;
  box-shadow:0 0 0 1px rgba(255,140,92,.55);
}

/* Pass / Fail contrast adjust */
.theme-dark .fail {
  color:#ff8f95;
  border-color:#ff626c;
}
.theme-dark .pass {
  color:#3ae0a0;
  border-color:#30c68c;
}

/* Placeholder (when present) */
.theme-dark .cm-placeholder {
  color:#5c6879;
  font-style:italic;
}

/* Subtle focus ring harmonize */
.theme-dark .CodeMirror-focused {
  background:#242d3a;
  box-shadow:0 0 0 2px rgba(90,130,255,.25);
}

/* Button contrast in dark */
.theme-dark button {
  background:linear-gradient(90deg,#4d6dff 70%,#43b5ff 100%);
}
.theme-dark .help-btn {
  background:#273345 !important;
  color:#b8c6dc !important;
  border-color:#4b5d77 !important;
}
.theme-dark .help-btn:hover {
  background:#314057 !important;
}

/* Modal content readability */
.theme-dark .modal-content {
  background:#242c37;
  border-color:#3d4b5e;
}
.theme-dark .rule-list {
  color:#b0bccb;
}
.theme-dark .rule-list h4 {
  color:#85aaff;
}

/* Result panel */
.theme-dark .result {
  background:#242d39;
  border-color:#3d4a5c;
  color:#d8e2ef;
}
.theme-dark .error-msg:hover {
  background:#2d3846;
  border-color:#514040;
}
/* ========================================================================== */

/* 5. 버튼 */
button, .help-btn {
  font-family: inherit;
  position: relative;
  isolation: isolate;
}

button {
  width: 100%;
  margin-top: 12px;
  font-size: 1.07rem;
  font-weight: 600;
  background: var(--gradient-btn);
  color: #fff;
  border: none;
  border-radius: var(--radius-m);
  padding: 14px 0;
  cursor: pointer;
  box-shadow: 0 4px 18px -4px rgba(54,84,255,.45), 0 2px 8px rgba(0,0,0,.12);
  transition: var(--transition);
  letter-spacing: .3px;
}

button:hover,
button:focus-visible {
  filter: brightness(1.05);
  transform: translateY(-2px);
  box-shadow: 0 6px 26px -6px rgba(54,84,255,.55), 0 4px 14px rgba(0,0,0,.18);
}

button:active {
  transform: translateY(0);
  box-shadow: 0 2px 10px rgba(0,0,0,.18);
}

button:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

/* 6. 도움/히스토리 버튼 그룹 */
.button-group.help-group {
  position: absolute;
  top: 30px;
  right: 32px;
  display: flex;
  gap: 10px;
  flex-wrap: nowrap;          /* PC에선 한 줄 유지 */
  align-items: center;
  z-index: 2;
}

.help-btn {
  padding: 8px 16px;
  font-size: .9rem;
  font-weight: 600;
  color: var(--c-primary) !important;
  background: #fff !important;
  border: 1.5px solid var(--c-primary) !important;
  border-radius: 999px !important;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  transition: var(--transition);
  box-shadow: var(--shadow-s);
}

.help-btn::before {
  content: "?";
  width: 18px; height: 18px;
  background: var(--c-primary);
  color: #fff;
  display: grid;
  place-items: center;
  border-radius: 50%;
  font-size: .7rem;
  font-weight: 700;
}

.help-btn:hover,
.help-btn:focus-visible {
  background: var(--c-primary-soft) !important;
  transform: translateY(-2px);
  box-shadow: 0 4px 14px -4px rgba(54,84,255,.35);
  outline: none;
}

.help-btn:active {
  transform: translateY(0);
}

/* 아이콘 버튼 스타일 (기존 ? 프리픽스 제거) */
.help-btn::before { content: none !important; }
.help-btn .icon {
  width: 16px; height: 16px;
  display: inline-block;
  margin-right: 6px;
  line-height: 0;
  color: currentColor;
}

/* 7. 결과 패널 */
.result {
  margin-top: 26px;
  min-height: 54px;
  max-height: 320px;
  overflow-y: auto;
  background: var(--c-bg-panel-alt);
  border: 1px solid var(--c-border-strong);
  border-radius: var(--radius-m);
  padding: 20px 22px 18px;
  font-size: 1rem;
  line-height: 1.55;
  display: none;
  box-shadow: var(--shadow-s);
  transition: background var(--transition), border-color var(--transition);
}

.result::-webkit-scrollbar {
  width: 10px;
}
.result::-webkit-scrollbar-thumb {
  background: #c7d2e3;
  border-radius: 5px;
}
.result::-webkit-scrollbar-thumb:hover {
  background: #b2becf;
}

.error-msg {
  padding: 8px 12px 8px 10px;
  margin: 2px 0 4px;
  border-radius: var(--radius-s);
  transition: var(--transition);
  position: relative;
  line-height: 1.45;
  background: transparent;
  border: 1px solid transparent;
}

.error-msg:hover {
  background: #fff;
  border-color: #f0d5d5;
  box-shadow: 0 2px 10px -2px rgba(255,83,83,.2);
  transform: translateX(6px);
}

.error-msg:active {
  transform: translateX(3px);
}

.error-msg:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px rgba(255,83,83,.35);
  background: #fff;
}

/* 8. 상태 박스 */
.pass, .fail {
  border-left: 6px solid;
  padding: 10px 12px 12px;
  font-weight: 600;
  border-radius: var(--radius-s);
  margin-bottom: 6px;
}

.pass {
  color: var(--c-success);
  background: var(--c-success-bg);
  border-color: var(--c-success);
}

.fail {
  color: var(--c-danger);
  background: var(--c-danger-bg);
  border-color: var(--c-danger);
}

/* 9. 하이라이트 */
.error-highlight {
  background: var(--c-highlight) !important;
  border-radius: 4px !important;
  box-shadow: 0 0 0 1px rgba(255,140,92,.4);
}

/* 10. 모달 */
.modal {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(22,30,46,.55);
  backdrop-filter: blur(4px) saturate(1.2);
  z-index: 1000;
  padding: 40px 18px 60px;
  overflow-y: auto;
}

.modal-content {
  position: relative;
  background: var(--c-bg-panel);
  margin: 0 auto 40px;
  padding: 30px 34px 40px;
  width: min(820px, 100%);
  border-radius: 28px;
  border: 1px solid var(--c-border-strong);
  box-shadow: 0 20px 50px -20px rgba(40,60,140,.35), 0 8px 24px rgba(0,0,0,.15);
  animation: modalIn .42s cubic-bezier(.32,.72,.24,1);
  max-height: 82vh;
  overflow-y: auto;
  overscroll-behavior: contain;
}

@keyframes modalIn {
  0% { opacity: 0; transform: translateY(24px) scale(.97); }
  60% { opacity: 1; }
  100% { transform: translateY(0) scale(1); }
}

.modal-content::-webkit-scrollbar {
  width: 11px;
}
.modal-content::-webkit-scrollbar-track {
  background: transparent;
}
.modal-content::-webkit-scrollbar-thumb {
  background: #c5cfdd;
  border-radius: 6px;
}
.modal-content::-webkit-scrollbar-thumb:hover {
  background: #b1bccd;
}

.close {
  position: absolute;
  top: 18px;
  right: 20px;
  font-size: 30px;
  cursor: pointer;
  padding: 4px 10px;
  border-radius: 10px;
  line-height: 1;
  color: var(--c-text-soft);
  transition: var(--transition);
}

.close:hover,
.close:focus-visible {
  background: var(--c-primary-soft);
  color: var(--c-primary);
  outline: none;
}

/* 11. 규칙 리스트 */
.rule-list {
  margin-top: 10px;
  font-size: .95rem;
  line-height: 1.55;
  color: var(--c-text-soft);
}

.rule-list h4 {
  color: var(--c-primary);
  margin: 30px 0 10px;
  font-size: 1.05rem;
  letter-spacing: -.5px;
}

.rule-list ul {
  margin: 12px 0 4px;
  padding-left: 20px;
}

.rule-list li {
  margin: 6px 0;
}

/* 12. 포커스 접근성 */
:focus-visible {
  outline: 2px solid var(--c-focus);
  outline-offset: 2px;
}

/* 13. 반응형 */
@media (max-width: 840px) {
  .container {
    margin: 30px 14px 70px;
    padding: 34px 24px 30px;
  }
  .button-group.help-group {
    top: 20px;
    right: 20px;
  }
  .modal-content {
    padding: 26px 26px 34px;
  }
}

/* 14. 다크 모드에서 특수 요소 대비 조정 */
.theme-dark .CodeMirror-focused {
  background: #273245;
}
.theme-dark .error-highlight {
  box-shadow: 0 0 0 1px rgba(255,150,110,.55);
}
.theme-dark .fail { background: #3a2628; }
.theme-dark .pass { background: #233a30; }

/* 15. Micro UI 디테일 */
.error-msg span:first-child {
  font-size: .75rem;
  opacity: .9;
  transform: translateY(-1px);
}

/* === Remove full-line gradient; use slim left bar ======================= */
/* 1) 기존 cat-* 배경 제거 */
.theme-dark .CodeMirror .cat-top,
.theme-dark .CodeMirror .cat-midtop,
.theme-dark .CodeMirror .cat-mid,
.theme-dark .CodeMirror .cat-low,
.CodeMirror .cat-top,
.CodeMirror .cat-midtop,
.CodeMirror .cat-mid,
.CodeMirror .cat-low {
  background: none !important;
  color: inherit;            /* 기본 텍스트 컬러 사용 */
  padding-left: 4px;         /* 최소 패딩 */
  border-left: none;
  transition: none;          /* 테마 토글 시 깜빡임 방지 */
}

/* 2) 좌측 얇은 구분선만 pseudo-element 로 */
.CodeMirror .cat-top::before,
.CodeMirror .cat-midtop::before,
.CodeMirror .cat-mid::before,
.CodeMirror .cat-low::before {
  content:"";
  position:absolute;
  left:0; top:0; bottom:0;
  width:3px;
  border-radius:2px;
  background: var(--c-primary);
  opacity:.55;
}
.CodeMirror .cat-midtop::before { background: #4a7cff; opacity:.5; }
.CodeMirror .cat-mid::before    { background: #2f9bd9; opacity:.55; }
.CodeMirror .cat-low::before    { background: #3aa9ef; opacity:.55; }

.theme-dark .CodeMirror .cat-top::before  { background:#5a8dff; opacity:.7; }
.theme-dark .CodeMirror .cat-midtop::before{ background:#4d7fe6; }
.theme-dark .CodeMirror .cat-mid::before  { background:#3c96d9; }
.theme-dark .CodeMirror .cat-low::before  { background:#4bb5ff; }

/* 3) hover 배경 제거 */
.CodeMirror .cat-top:hover,
.CodeMirror .cat-midtop:hover,
.CodeMirror .cat-mid:hover,
.CodeMirror .cat-low:hover,
.theme-dark .CodeMirror .cat-top:hover,
.theme-dark .CodeMirror .cat-midtop:hover,
.theme-dark .CodeMirror .cat-mid:hover,
.theme-dark .CodeMirror .cat-low:hover {
  background: none !important;
}

/* 4) 단색 강제 블록(라인 가독성 떨어뜨림) 비활성화 -> 필요 시 .mono-text 클래스에 한정
   기존 단색 블록 앞에 주석 처리 또는 아래로 대체 */
.mono-text .CodeMirror,
.mono-text .CodeMirror * {
  color: inherit !important;
}

/* 5) 테마 토글 순간 재계산 시 잔상 줄이기 */
html.theme-dark .CodeMirror * {
  transition: color .15s ease;
}

/* 카테고리 라인 가독성 (라이트/다크 공통 기본) */
.CodeMirror .cat-top    { font-weight:700; }
.CodeMirror .cat-midtop { font-weight:600; }
.CodeMirror .cat-mid    { font-weight:600; }
.CodeMirror .cat-low    { font-weight:500; }

/* 다크 테마 전용 색 / 배경 강조 */
.theme-dark .CodeMirror .cat-top {
  background: linear-gradient(90deg,#27324a 0%,rgba(39,50,74,0) 85%);
  color:#9fc6ff;
  border-left:4px solid #5a8dff;
  padding-left:6px;
}
.theme-dark .CodeMirror .cat-midtop {
  background: linear-gradient(90deg,#262f43 0%,rgba(38,47,67,0) 85%);
  color:#b4d3ff;
  border-left:3px solid #4877e6;
  padding-left:6px;
}
.theme-dark .CodeMirror .cat-mid {
  background: linear-gradient(90deg,#253442 0%,rgba(37,52,66,0) 85%);
  color:#d3e6ff;
  border-left:3px solid #3c96d9;
  padding-left:6px;
}
.theme-dark .CodeMirror .cat-low {
  background: linear-gradient(90deg,#2a3844 0%,rgba(42,56,68,0) 80%);
  color:#cfe3f4;
  border-left:2px solid #4bb5ff;
  padding-left:6px;
}

/* 라이트 모드도 은은하게 */
.CodeMirror .cat-top {
  background: linear-gradient(90deg,#eef4ff 0%,rgba(238,244,255,0) 85%);
  border-left:4px solid #3553ff;
  padding-left:6px;
  color:#1f3b86;
}
.CodeMirror .cat-midtop {
  background: linear-gradient(90deg,#f2f6ff 0%,rgba(242,246,255,0) 85%);
  border-left:3px solid #4c6dff;
  padding-left:6px;
  color:#2c4d9d;
}
.CodeMirror .cat-mid {
  background: linear-gradient(90deg,#f5f9ff 0%,rgba(245,249,255,0) 85%);
  border-left:3px solid #2492d9;
  padding-left:6px;
  color:#21506d;
}
.CodeMirror .cat-low {
  background: linear-gradient(90deg,#f7fbff 0%,rgba(247,251,255,0) 80%);
  border-left:2px solid #3aa9ef;
  padding-left:6px;
  color:#2a586c;
}

/* 줄 간 경계 보정 (하단 여백 소폭) */
.CodeMirror .cat-top,
.CodeMirror .cat-midtop,
.CodeMirror .cat-mid,
.CodeMirror .cat-low {
  box-shadow: 0 1px 0 rgba(255,255,255,.04), 0 -1px 0 rgba(0,0,0,.04);
  transition: background .25s ease, color .25s ease;
}

.theme-dark .CodeMirror .cat-top:hover,
.theme-dark .CodeMirror .cat-midtop:hover,
.theme-dark .CodeMirror .cat-mid:hover,
.theme-dark .CodeMirror .cat-low:hover {
  background: rgba(110,155,255,.12);
}

.CodeMirror .cat-top:hover,
.CodeMirror .cat-midtop:hover,
.CodeMirror .cat-mid:hover,
.CodeMirror .cat-low:hover {
  background: rgba(70,110,255,.10);
}

/* === Text color unify (Plain mode) =========================================
   요구: 일반 모드 -> 검정(#000), 다크 모드 -> 흰색(#fff)
   토큰별 색상(cm-* 클래스) 및 카테고리 색상(cat-*)을 모두 무시하고 단색으로 통일.
   필요 시 이 블록을 삭제/주석 처리하면 기존 컬러 복구.
--------------------------------------------------------------------------- */
.CodeMirror,
.CodeMirror pre,
.CodeMirror-line,
.CodeMirror-line span,
.CodeMirror span,
.CodeMirror .cm-header,
.CodeMirror .cm-strong,
.CodeMirror .cm-em,
.CodeMirror .cm-link,
.CodeMirror .cm-string,
.CodeMirror .cm-quote,
.CodeMirror .cm-comment,
.CodeMirror .cm-url,
.CodeMirror .cm-number,
.CodeMirror .cm-keyword,
.CodeMirror .cm-hr,
.CodeMirror .cat-top,
.CodeMirror .cat-midtop,
.CodeMirror .cat-mid,
.CodeMirror .cat-low {
  color:#000 !important;
}

.theme-dark .CodeMirror,
.theme-dark .CodeMirror pre,
.theme-dark .CodeMirror-line,
.theme-dark .CodeMirror-line span,
.theme-dark .CodeMirror span,
.theme-dark .CodeMirror .cm-header,
.theme-dark .CodeMirror .cm-strong,
.theme-dark .CodeMirror .cm-em,
.theme-dark .CodeMirror .cm-link,
.theme-dark .CodeMirror .cm-string,
.theme-dark .CodeMirror .cm-quote,
.theme-dark .CodeMirror .cm-comment,
.theme-dark .CodeMirror .cm-url,
.theme-dark .CodeMirror .cm-number,
.theme-dark .CodeMirror .cm-keyword,
.theme-dark .CodeMirror .cm-hr,
.theme-dark .CodeMirror .cat-top,
.theme-dark .CodeMirror .cat-midtop,
.theme-dark .CodeMirror .cat-mid,
.theme-dark .CodeMirror .cat-low {
  color:#fff !important;
}

/* (선택) 하이라이트된 오류 텍스트도 대비 확보 */
.theme-dark .error-highlight { color:#fff !important; }
.error-highlight { color:#000 !important; }

/* 0) 모바일 겹침/깨짐 방지 공통 */
*,
*::before,
*::after { box-sizing: border-box; }
img, svg { max-width: 100%; height: auto; }

/* 3. 페이지 기본 (여백/오버랩 안전) */
.container { overflow: hidden; }

/* 반응형 보강: 세로 화면에서 버튼 그룹 오버랩 방지 */
@media (max-width: 720px) {
  .container {
    margin: 24px 12px 36px;
    padding: 22px 16px 18px;
    border-radius: 16px;
  }
  /* 상단 버튼: 절대 위치 → 일반 흐름(그리드) */
  .button-group.help-group {
    position: static;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
    margin: 8px 0 12px;
  }
  .help-btn {
    padding: 10px 12px;
    font-size: .88rem;
    justify-content: center;
  }
  h2 { margin: 6px 0 12px; }
  .CodeMirror {
    font-size: 13px;
    min-height: 200px;
  }
  /* 결과 패널 높이 제한으로 에디터와 겹침 방지 */
  .result { max-height: 38vh; }
  /* 모달 내부 패딩/반경 축소 */
  .modal { padding: 18px 12px 24px; }
  .modal-content {
    width: 100%;
    border-radius: 16px;
    padding: 18px 16px 20px;
    max-height: calc(100vh - 40px);
  }
}

/* 초소형 디바이스(아이폰 SE 등) 추가 안전장치 */
@media (max-width: 380px) {
  .button-group.help-group { grid-template-columns: 1fr 1fr 1fr; gap: 6px; }
  .help-btn { padding: 9px 10px; font-size: .84rem; }
  .help-btn .icon { margin-right: 4px; }
  .result { max-height: 42vh; }
  .CodeMirror { font-size: 12.5px; }
}

/* 세로 방향에 특화: 키보드가 올라올 때 모달이 꽉 차지 않도록 */
@media (orientation: portrait) {
  .modal-content { max-height: 86vh; }
}

/* 코드 라인 높이 기준(숫자/본문 동일 적용) */
:root {
  --line-code: 1.65;
}

/* CodeMirror 라인 높이 단일 기준으로 통일 */
.CodeMirror { line-height: var(--line-code); }
.CodeMirror pre { line-height: var(--line-code) !important; }

/* 거터 엘리먼트들도 같은 라인 높이 사용 */
.CodeMirror-gutter-wrapper,
.CodeMirror-gutter-elt,
.CodeMirror-linenumber {
  line-height: var(--line-code) !important;
}

/* 라인번호 글꼴/여백만 지정(높이는 라인 높이로 일치) */
.CodeMirror-linenumber {
  font-family: var(--font-mono);
  font-size: 12px;
  padding: 0 6px 0 4px;
  color: #6a7487;
}
.theme-dark .CodeMirror-linenumber { color:#8ba0b8; }

/* 테마 버튼 숨김 및 모바일 레이아웃 2열로 보정 */
#themeToggle { display: none !important; } /* 잔여 테마 버튼 완전 제거 대비 */
@media (max-width: 720px) {
  .button-group.help-group {
    position: static;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
    margin: 8px 0 12px;
  }
}

/* 모바일/접근성: 전역 애니메이션 차단 범위 축소 (리플/에디터 제외) */
@media (prefers-reduced-motion: reduce) {
  .container, .help-btn, .result, .modal, .error-msg, .close, button {
    animation: none !important;
    transition: none !important;
  }
  /* 원하면 리플도 끌 수 있음 */
  body:not(.ripple-force)::before { animation: none !important; }
}

/* === PC 전용 페이지 배경 리플(물결) 효과 - 가시성 강화 ===================== */
@media (hover: hover) and (pointer: fine) {
  body {
    background:
      radial-gradient(1200px 800px at 10% 0%, #eef3ff 0%, #f7f9ff 35%, #fbfcff 60%, #ffffff 100%);
  }
  body::after {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
    background-image:
      radial-gradient(#2d4bff0a 1px, transparent 1px),
      radial-gradient(#2d4bff08 1px, transparent 1px);
    background-size: 24px 24px, 24px 24px;
    background-position: 0 0, 12px 12px;
    mix-blend-mode: multiply;
  }
}

/* 컨테이너가 배경 위로 떠 보이도록 레이어 고정 */
.container {
  isolation: isolate;
  z-index: 1;
  box-shadow:
    0 20px 60px -20px rgba(12, 28, 60, .18),
    0 8px 24px -12px rgba(12, 28, 60, .12),
    0 1px 0 rgba(12, 28, 60, .05);
}

/* 전역 버튼 스타일 → 도움 버튼 제외 */
button, .help-btn {
  font-family: inherit;
  position: relative;
  isolation: isolate;
}
button:not(.help-btn) {
  width: 100%;
  margin-top: 12px;
  font-size: 1.07rem;
  font-weight: 600;
  background: var(--gradient-btn);
  color: #fff;
  border: none;
  border-radius: var(--radius-m);
  padding: 14px 0;
  cursor: pointer;
  box-shadow: 0 4px 18px -4px rgba(54,84,255,.45), 0 2px 8px rgba(0,0,0,.12);
  transition: var(--transition);
  letter-spacing: .3px;
}
button:not(.help-btn):hover,
button:not(.help-btn):focus-visible {
  filter: brightness(1.05);
  transform: translateY(-2px);
  box-shadow: 0 6px 26px -6px rgba(54,84,255,.55), 0 4px 14px rgba(0,0,0,.18);
}
button:not(.help-btn):active {
  transform: translateY(0);
  box-shadow: 0 2px 10px rgba(0,0,0,.18);
}

/* 상단 도움 버튼 정렬 고정 */
.button-group.help-group {
  position: absolute;
  top: 30px;
  right: 32px;
  display: flex;
  gap: 10px;
  flex-wrap: nowrap;          /* PC에선 한 줄 유지 */
  align-items: center;
  z-index: 2;
}
.button-group.help-group .help-btn {
  width: auto !important;     /* 전역 100% 폭 무시 */
  flex: 0 0 auto;
  min-width: 0;
  margin: 0;
  padding: 8px 16px;
}

/* 모바일에서는 자동 줄바꿈(기존 규칙 유지) */
@media (max-width: 720px) {
  .button-group.help-group {
    position: static;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
    margin: 8px 0 12px;
  }
  .button-group.help-group .help-btn {
    justify-content: center;
  }
}

/* 랜딩 전용 스타일(메인 페이지에만 적용). 앱에 영향 없도록 body.landing로 스코프. */
body.landing {
  margin: 0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", sans-serif;
  color: #1f2937;
  background:
    radial-gradient(1000px 700px at 10% -10%, #eef3ff, transparent 60%),
    radial-gradient(900px 700px at 110% 110%, #eaf6ff, transparent 60%),
    #f7f9ff;
  min-height: 100dvh;
  display: grid;
  place-items: center;
}
.landing-wrap {
  text-align: center;
  padding: 36px 28px;
  background: #fff;
  border: 1px solid #e5eaf3;
  border-radius: 20px;
  box-shadow: 0 18px 48px -22px rgba(20,40,120,.25), 0 2px 8px rgba(16,24,40,.06);
  max-width: 720px;
  width: min(92vw, 720px);
}
.landing-title {
  margin: 0 0 10px;
  font-size: clamp(20px, 3.2vw, 28px);
  display: inline-flex; align-items: center; gap: 10px;
}
.landing-logo { border-radius: 6px; }
.landing-sub { margin: 4px 0 18px; color: #475569; }

/* 링크 버튼 그룹 */
.cta-group { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }

.cta-btn {
  display: inline-block;
  padding: 12px 18px;
  border-radius: 12px;
  background: linear-gradient(90deg,#3553ff 70%,#1b95e6);
  color: #fff; text-decoration: none; font-weight: 700;
  box-shadow: 0 8px 22px -8px rgba(53,83,255,.5);
  transition: transform .15s ease, filter .15s ease, box-shadow .15s ease;
}
.cta-btn:hover { filter: brightness(1.05); transform: translateY(-1px); }

/* 보조 버튼(하얀색) */
.cta-btn.alt {
  background: #ffffff;
  color: #1f2b44;
  border: 1px solid #d9e1f2;
  box-shadow: 0 4px 16px -6px rgba(20,60,160,.15), 0 1px 3px rgba(0,0,0,.06);
}
.cta-btn.alt:hover { background: #f7f9ff; }

/* 메인 페이지의 CSS 파일에 추가 */
.featured-link {
  margin: 20px 0;
  text-align: center;
}

.restaurant-link {
  display: inline-block;
  background-color: #f8f9fa;
  border-radius: 10px;
  padding: 20px;
  text-decoration: none;
  color: #333;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
  max-width: 300px;
}

.restaurant-link:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.restaurant-link img {
  width: 64px;
  height: 64px;
  margin-bottom: 10px;
}

.restaurant-link h3 {
  color: #0b5ed7;
  margin-bottom: 10px;
}

.restaurant-link p {
  font-size: 14px;
  color: #6c757d;
}