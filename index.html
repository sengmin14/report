<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>업무보고 자동검증기</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.13/lib/codemirror.css" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <h2>업무보고 자동검증기</h2>
      <div class="button-group help-group">
        <button id="helpBtn" class="help-btn">검증 규칙</button>
        <button id="changelogBtn" class="help-btn" style="margin-left:4px;">기능 추가 이력</button>
      </div>
      <textarea id="code" name="code">여기에 붙여넣으세요</textarea>
      <div id="result" class="result"></div>
    </div>

    <!-- 규칙 안내 모달 -->
    <div id="ruleModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h3>검증 규칙 안내</h3>
        <div class="rule-list">
          <h4>1. 공백 / 들여쓰기</h4>
          <ul>
            <li>라인 시작 공백은 1칸까지만 허용 (2칸 이상 → 오류)</li>
            <li>의도된 계층 표시는 기호(1. (1) - ․) 자체로 표현 (추가 들여쓰기 사용 금지)</li>
          </ul>

          <h4>2. 날짜 표기</h4>
          <ul>
            <li>허용 형식: <code>(8/23)</code>, <code>(~7/30)</code></li>
            <li>월/일 앞 0 금지 (예: (08/23), (7/05) → 오류)</li>
            <li><code>까지</code> 포함 금지 (예: (7/30까지), (~8/15까지) → 오류)</li>
          </ul>

            <h4>3. 괄호 / 대괄호 공백</h4>
          <ul>
            <li><code>( )</code>, <code>[ ]</code> 양옆/안쪽에 공백 금지 (예: <code>( 값 )</code>, <code>[ 값]</code> 모두 오류)</li>
            <li>예외: 중분류/소분류 시작 기호 뒤 즉시 오는 괄호 패턴은 허용 (예: <code>- (설명)</code>)</li>
          </ul>

          <h4>4. 특수기호</h4>
          <ul>
            <li><code>></code>, <code>:</code> 앞뒤 공백 금지 (예: <code>A > B</code> → 오류, <code>A>B</code>만 허용)</li>
            <li><code>+</code> 는 양쪽 정확히 1칸 공백 (예: <code>A + B</code> / <code>A+B</code>, <code>A  + B</code> 모두 오류)</li>
            <li><code>,</code> 앞 공백 금지 / 뒤 정확히 1칸 (예: <code>값,다음</code> 또는 <code>값,  두칸</code> → 오류)</li>
          </ul>

          <h4>5. 소분류 상태 중복</h4>
          <ul>
            <li>한 중분류(-) 아래 연속된 소분류(․)들이 모두 동일 상태(완료/진행중/보류/취소/~M/D)면</li>
            <li>→ 소분류 줄들의 상태는 제거하고 중분류 줄에만 1회 기입</li>
          </ul>

          <h4>6. 오류 표시 / 기타</h4>
          <ul>
            <li>오류는 최대 50건만 목록에 표시 (초과분 개수는 요약 표기)</li>
            <li>오류 항목 클릭 시 해당 행으로 이동 및 관련 영역 하이라이트</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- 기능 추가 이력 모달 -->
    <div id="changelogModal" class="modal">
      <div class="modal-content">
        <span class="close changelog-close">&times;</span>
        <h3>기능 추가 이력</h3>
        <div class="rule-list">
          <ul>
            <li><b>v1.0.0</b> - 기본 UI, 검증 규칙 안내 모달, 수동 검증 기능</li>
            <li><b>v1.1.0</b> - 오류 메시지 클릭 시 해당 행 이동 및 하이라이트 기능</li>
            <li><b>v1.2.0</b> - 날짜/괄호/특수문자 하이라이트 정확도 개선</li>
            <li><b>v1.3.0</b> - 모달 ESC/배경 클릭 닫기, 반응형 UI 개선</li>
            <li><b>v1.4.0</b> - 소분류 상태 중복 체크 로직, 코드 리팩토링</li>
            <li><b>v1.5.0</b> - 실시간 검증 (버튼 제거, 500ms 디바운스) 및 성능 최적화</li>
            <li><b>v1.6.0</b> - 기능 추가 이력 모달 정식 도입 / 구조 정리</li>
            <li><b>v1.7.0</b> - 오류 메시지 출력부 스크롤 처리 및 개수(최대 50) 제한</li>
            <li><b>v1.8.0</b> - 하이라이트 로직 재구성 (data-type 기반, 이벤트 위임, 중복 핸들러 제거)</li>
            <li><b>v1.8.1</b> - 들여쓰기 규칙 메시지(‘2칸 이상 금지’) 정합성 수정, 규칙 안내 모달 전체 갱신, 오류창 배경/가로 스크롤 UI 개선</li>
          </ul>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.13/lib/codemirror.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.13/mode/markdown/markdown.js"></script>
    <script src="main.js"></script>
  </body>
</html>
