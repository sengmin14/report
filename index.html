<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>업무보고 자동검증기</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.13/lib/codemirror.css" />
    <link rel="stylesheet" href="style.css" />
    <!-- 가독성 좋은 한글/라틴 UI 폰트 + 모노스페이스(에디터) -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable-dynamic-subset.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jetbrains-mono/2.304.0/web/woff2/JetBrainsMono.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- 모바일 글자 확대 방지 -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <div class="container">
      <h2>업무보고 자동검증기</h2>
      <div class="button-group help-group">
        <button id="themeToggle" class="help-btn" type="button">테마</button>
        <button id="helpBtn" class="help-btn" type="button">규칙</button>
        <button id="changelogBtn" class="help-btn" type="button">이력</button>
      </div>
      <textarea id="code" name="code">여기에 붙여넣으세요</textarea>
      <div id="result" class="result"></div>
    </div>

    <!-- 규칙 안내 모달 -->
    <div id="ruleModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h3>검증 규칙 안내</h3>
        <div class="rule-list">
          <h4>1. 공백 / 들여쓰기</h4>
          <ul>
            <li>라인 시작 공백은 1칸까지만 허용 (2칸 이상 → 오류)</li>
            <li>계층 구조는 기호(1. / (1) / - / ․)로만 표현 (추가 들여쓰기 금지)</li>
          </ul>

          <h4>2. 날짜 표기</h4>
            <ul>
              <li>허용: <code>(8/23)</code>, <code>(~7/30)</code></li>
              <li>월/일 0으로 시작 금지 (예: (08/23), (7/05))</li>
              <li><code>까지</code> 포함 금지 (예: (7/30까지), (~8/15까지))</li>
            </ul>

          <h4>3. 괄호 / 대괄호 공백</h4>
          <ul>
            <li><code>( )</code>, <code>[ ]</code> 양옆 및 내부 불필요 공백 금지 (예: <code>( 값)</code>, <code>[값 ]</code>)</li>
            <li>예외: 중분류(-) / 소분류(․) 기호 직후 바로 오는 괄호는 허용 (<code>- (설명)</code>)</li>
          </ul>

          <h4>4. 특수기호 공백 규칙</h4>
          <ul>
            <li><code>></code>, <code>:</code> 앞뒤 공백 금지 (예: <code>A>B</code>만 허용)</li>
            <li><code>+</code> 앞뒤 정확히 1칸 (예: <code>A + B</code>; <code>A+B</code>, <code>A  + B</code> 모두 오류)</li>
            <li><code>,</code> 앞 공백 금지 / 뒤 1칸 (예: <code>값, 다음</code>)</li>
          </ul>

          <h4>5. 소분류 상태 중복</h4>
          <ul>
            <li>한 중분류(-) 아래 연속된 소분류(․) 상태가 모두 동일(완료/진행중/보류/취소/~M/D)하면</li>
            <li>→ 소분류의 상태 제거, 중분류 라인에만 1회 표기</li>
          </ul>

          <h4>6. 혼동/유사 문자 금지</h4>
          <ul>
            <li>소분류 기호는 반드시 <code>․</code> (여가부 전용 점, U+2024) 1글자만 사용 ('.' / '·'(U+00B7) / '•'(U+2022) 등 유사품 문자는 모두 오류)</li>
            <li>중분류 기호는 ASCII <code>-</code>만 허용 (en dash ‘–’, em dash ‘—’ 등 금지)</li>
            <li>범위/날짜 틸드는 ASCII <code>~</code>만 허용 (全角 ‘～’, 유사 ‘∼’ 금지)</li>
            <li>전각 문장부호 금지: （ ） ： ＞ ＋ ， → 각각 ( ) : > + , 로 교체</li>
          </ul>

          <h4>7. 오류 표시 / 기타</h4>
          <ul>
            <li>오류 목록 최대 50개 표시 (초과분 개수 요약)</li>
            <li>오류 클릭 시 해당 행으로 이동 & 해당 패턴만 하이라이트 (오류창 스크롤 위치 유지)</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- 기능 추가 이력 모달 -->
    <div id="changelogModal" class="modal">
      <div class="modal-content">
        <span class="close changelog-close">&times;</span>
        <h3>기능 추가 이력</h3>
        <div class="rule-list">
          <ul>
            <li><b>v1.0.0</b> - 기본 UI, 규칙 모달, 수동 검증</li>
            <li><b>v1.1.0</b> - 오류 클릭 이동/하이라이트</li>
            <li><b>v1.2.0</b> - 날짜·괄호·특수문자 하이라이트 개선</li>
            <li><b>v1.3.0</b> - ESC/배경 클릭 모달 닫기, 반응형 개선</li>
            <li><b>v1.4.0</b> - 소분류 상태 중복 로직 도입, 리팩터링</li>
            <li><b>v1.5.0</b> - 실시간 검증(버튼 제거, 500ms 디바운스) & 성능 최적화</li>
            <li><b>v1.6.0</b> - 기능 추가 이력 모달 도입 / 구조 정리</li>
            <li><b>v1.7.0</b> - 오류 목록 스크롤 & 50개 제한</li>
            <li><b>v1.8.0</b> - data-type 기반 하이라이트/이벤트 위임</li>
            <li><b>v1.8.1</b> - 들여쓰기 메시지 정합성, 규칙 모달/오류창 UI 개선</li>
            <li><b>v1.9.0</b> - 혼동 문자(유사 소분류 기호, 전각 기호, 유사 dash/tilde) 검출 및 정밀 하이라이트</li>
            <li><b>v1.9.1</b> - 소분류 시작 시 여가부 전용 점 체크로직 추가(유사제품 사용 방지)</li>
          </ul>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.13/lib/codemirror.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.13/mode/markdown/markdown.js"></script>
    <script src="main.js"></script>
  </body>
</html>
